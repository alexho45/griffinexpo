
<h4>EXPO EVENTS SCHEDULING</h4>

<h5>
  Would you require transportation to and from the EXPO to your hotel?
  <br>
  (<a data-toggle="modal" data-target="#bus-modal">Click here</a> to check schedule)
</h5>

<%= form_tag(select_buses_companies_path, method: :post) do %>
  <h4>
    <%= radio_button_tag "checked_buses", true, checked = @company.event.buses.joins(:attendees).any? || true, class: 'checked_buses' %> YES
  </h4>
  <%= hidden_field_tag :attendees_count, @company.attendees.count %>
  <%= hidden_field_tag :already_done, @company.event.buses.joins(:attendees).any? %>
  <% @company.event.buses.each_with_index do |bus, index| %>
    <h5>
      &emsp;
      <%= check_box_tag "buses[#{bus.id}][]", bus.id, checked = (bus.attendees & @company.attendees).any?, data: { seats: bus.available_seats }, class: 'bus-checkbox' %>
      <%= "[MA EXPO BUS ##{index+1} - #{bus.available_seats} seats remaining]" %>
      <% if (bus.attendees & @company.attendees).any? %> (<%= (bus.attendees & @company.attendees).size %> of your attendees) <% end %>
    </h5>
  <% end %>
  <h4>
    <%= radio_button_tag "checked_buses", false, checked = !@company.event.buses.joins(:attendees).any? || false %> NO (We will have our own transportation)
  </h4>

  <div class="buses-error">
    You have selected a bus that will not accommodate the number of attendees you have, please select another
  </div>

  <%= submit_tag 'BACK', class: 'btn btn-primary', name: :step_back %>
  <%= submit_tag 'NEXT', class: 'btn btn-primary next' %>
<% end %>

<div class="modal fade" id="bus-modal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-body">
        <iframe src="http://www.griffins.com/events/expo16.asp#bus" width="1000" height="580" frameborder="0" allowtransparency="true"></iframe> 
      </div>
    </div>
  </div>
</div>
